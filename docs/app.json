[{"name":"app.R","content":"library(shiny)\r\nlibrary(shinythemes)\r\nlibrary(dplyr)\r\n\r\n# ======================\r\n# Load Data\r\n# ======================\r\nVolleyData <- read.csv(\"VolleyballData2025.csv\", stringsAsFactors = FALSE)\r\nVolleyData$Date <- as.Date(VolleyData$Date, format = \"%m/%d/%y\")\r\n\r\n# ======================\r\n# Metric Functions\r\n# ======================\r\nServingAvg <- function(data, player) {\r\n  pdata <- subset(data, Name == player)\r\n  if (nrow(pdata) == 0) return(NA)\r\n  round(sum(pdata$ServeIn, na.rm = TRUE)/sum(pdata$TotalServe, na.rm = TRUE), 3)\r\n}\r\n\r\nScoringAvg <- function(data, player) {\r\n  pdata <- subset(data, Name == player)\r\n  if (nrow(pdata) == 0) return(NA)\r\n  round(sum(pdata$PointWon, na.rm = TRUE)/sum(pdata$TeamTotalScore, na.rm = TRUE), 3)\r\n}\r\n\r\nErrorRate <- function(data, player) {\r\n  pdata <- subset(data, Name == player)\r\n  if (nrow(pdata) == 0) return(NA)\r\n  round(sum(pdata$UnforcedError, na.rm = TRUE)/sum(pdata$OpponentTotalScore, na.rm = TRUE), 3)\r\n}\r\n\r\nNetScoreRate <- function(data, player) {\r\n  pdata <- subset(data, Name == player)\r\n  if (nrow(pdata) == 0) return(NA)\r\n  round((sum(pdata$PointWon, na.rm = TRUE)-sum(pdata$UnforcedError, na.rm = TRUE))/\r\n          sum(pdata$TeamTotalScore, na.rm = TRUE), 3)\r\n}\r\n\r\n# ======================\r\n# Precompute Player Stats\r\n# ======================\r\nPlayerNames <- unique(VolleyData$Name)\r\n\r\nstats_df <- do.call(rbind, lapply(PlayerNames, function(player) {\r\n  pdata <- subset(VolleyData, Name == player)\r\n  data.frame(\r\n    Name = player,\r\n    TotalServes = sum(pdata$TotalServe, na.rm = TRUE),\r\n    ServeIn = sum(pdata$ServeIn, na.rm = TRUE),\r\n    ServingAvg = ServingAvg(VolleyData, player),\r\n    TotalPointsWon = sum(pdata$PointWon, na.rm = TRUE),\r\n    ScoringAvg = ScoringAvg(VolleyData, player),\r\n    TotalUnforcedErrors = sum(pdata$UnforcedError, na.rm = TRUE),\r\n    ErrorRate = ErrorRate(VolleyData, player),\r\n    NetScoreRate = NetScoreRate(VolleyData, player),\r\n    TotalAssists = sum(pdata$Assist, na.rm = TRUE),\r\n    stringsAsFactors = FALSE\r\n  )\r\n}))\r\n\r\n# ======================\r\n# Shiny App\r\n# ======================\r\nui <- fluidPage(\r\n  theme = shinytheme(\"spacelab\"),\r\n  titlePanel(\"Volleyball Dashboard\"),\r\n  \r\n  tabsetPanel(\r\n    tabPanel(\"Player Metrics\",\r\n             tableOutput(\"player_metrics_table\"),\r\n             tableOutput(\"team_metrics_avg\")\r\n    ),\r\n    tabPanel(\"Player Totals\",\r\n             tableOutput(\"player_totals_table\"),\r\n             tableOutput(\"team_totals_avg\")\r\n    ),\r\n    tabPanel(\"Player Analysis\",\r\n             sidebarLayout(\r\n               sidebarPanel(\r\n                 selectInput(\"selected_player\", \"Select Player:\", choices = PlayerNames),\r\n                 width = 3\r\n               ),\r\n               mainPanel(\r\n                 h3(textOutput(\"player_title\")),\r\n                 tableOutput(\"player_individual_stats\"),\r\n                 br(),\r\n                 tableOutput(\"player_team_avg\"),\r\n                 br(),\r\n                 plotOutput(\"player_metrics_by_opponent\", height = \"350px\"),\r\n                 plotOutput(\"player_serving_line\", height = \"350px\")\r\n               )\r\n             )\r\n    ),\r\n    tabPanel(\"Team Overview\",\r\n             plotOutput(\"top_scorers\", height = \"400px\"),\r\n             plotOutput(\"top_errors\", height = \"400px\"),\r\n             plotOutput(\"net_score_heatmap\", height = \"400px\"),\r\n             plotOutput(\"team_points_line\", height = \"400px\")\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # ----------------------\r\n  # Tables\r\n  # ----------------------\r\n  output$player_metrics_table <- renderTable({\r\n    stats_df[, c(\"Name\", \"ServingAvg\", \"ScoringAvg\", \"ErrorRate\", \"NetScoreRate\")]\r\n  }, striped = TRUE, hover = TRUE)\r\n  \r\n  output$team_metrics_avg <- renderTable({\r\n    numeric_cols <- c(\"ServingAvg\", \"ScoringAvg\", \"ErrorRate\", \"NetScoreRate\")\r\n    team_avg <- round(colMeans(stats_df[, numeric_cols], na.rm = TRUE), 3)\r\n    df <- data.frame(Metric = \"Team Average\", t(team_avg), row.names = NULL)\r\n    df\r\n  }, striped = TRUE, hover = TRUE)\r\n  \r\n  output$player_totals_table <- renderTable({\r\n    stats_df[, c(\"Name\",\"TotalServes\",\"ServeIn\",\"TotalPointsWon\",\"TotalUnforcedErrors\",\"TotalAssists\")]\r\n  }, striped = TRUE, hover = TRUE)\r\n  \r\n  output$team_totals_avg <- renderTable({\r\n    numeric_cols <- c(\"TotalServes\",\"ServeIn\",\"TotalPointsWon\",\"TotalUnforcedErrors\",\"TotalAssists\")\r\n    team_avg <- round(colMeans(stats_df[, numeric_cols], na.rm = TRUE), 3)\r\n    df <- data.frame(Metric = \"Team Average\", t(team_avg), row.names = NULL)\r\n    df\r\n  }, striped = TRUE, hover = TRUE)\r\n  \r\n  output$player_title <- renderText({\r\n    paste(\"Player Analysis for\", input$selected_player)\r\n  })\r\n  \r\n  output$player_individual_stats <- renderTable({\r\n    pdata <- subset(stats_df, Name == input$selected_player)\r\n    pdata[, c(\"ServingAvg\",\"ScoringAvg\",\"ErrorRate\",\"NetScoreRate\",\"TotalAssists\",\"TotalUnforcedErrors\")]\r\n  }, striped = TRUE, hover = TRUE)\r\n  \r\n  output$player_team_avg <- renderTable({\r\n    numeric_cols <- c(\"ServingAvg\",\"ScoringAvg\",\"ErrorRate\",\"NetScoreRate\",\"TotalAssists\",\"TotalUnforcedErrors\")\r\n    team_avg <- round(colMeans(stats_df[, numeric_cols], na.rm = TRUE), 3)\r\n    df <- data.frame(Metric = \"Team Average\", t(team_avg), row.names = NULL)\r\n    df\r\n  }, striped = TRUE, hover = TRUE)\r\n  \r\n  # ----------------------\r\n  # Player Metrics by Opponent\r\n  # ----------------------\r\n  output$player_metrics_by_opponent <- renderPlot({\r\n    pdata <- subset(VolleyData, Name == input$selected_player)\r\n    plot_data <- pdata %>%\r\n      group_by(Opponent) %>%\r\n      summarise(\r\n        ScoringAvg = mean(PointWon/TeamTotalScore, na.rm = TRUE),\r\n        ErrorRate = mean(UnforcedError/OpponentTotalScore, na.rm = TRUE),\r\n        NetScoreRate = mean((PointWon-UnforcedError)/TeamTotalScore, na.rm = TRUE)\r\n      ) %>%\r\n      as.data.frame()\r\n    \r\n    bar_mat <- t(as.matrix(plot_data[, c(\"ScoringAvg\",\"ErrorRate\",\"NetScoreRate\")]))\r\n    bar_mid <- barplot(bar_mat, beside = TRUE,\r\n                       col = c(\"skyblue\",\"red\",\"purple\"),\r\n                       names.arg = plot_data$Opponent,\r\n                       las = 2,\r\n                       ylim = c(0, max(bar_mat, na.rm = TRUE)*1.3),\r\n                       main = paste(\"Player Metrics by Opponent:\", input$selected_player),\r\n                       ylab = \"Value\")\r\n    legend(\"topright\", legend = c(\"ScoringAvg\",\"ErrorRate\",\"NetScoreRate\"),\r\n           fill = c(\"skyblue\",\"red\",\"purple\"), bty = \"n\")\r\n  })\r\n  \r\n  # ----------------------\r\n  # Serving Average Over Games\r\n  # ----------------------\r\n  output$player_serving_line <- renderPlot({\r\n    pdata <- subset(VolleyData, Name == input$selected_player)\r\n    pdata <- pdata[order(pdata$Date), ]\r\n    \r\n    serving_avg <- ifelse(pdata$TotalServe > 0, pdata$ServeIn / pdata$TotalServe, NA)\r\n    point_colors <- ifelse(!is.na(serving_avg) & serving_avg > 0.5, \"green\",\r\n                           ifelse(!is.na(serving_avg), \"red\", NA))\r\n    \r\n    plot(serving_avg, type = \"n\",\r\n         ylim = c(0,1),\r\n         xaxt = \"n\",\r\n         main = paste(\"Serving Average Over Games:\", input$selected_player),\r\n         ylab = \"Serving Avg\", xlab = \"Game\")\r\n    \r\n    good <- which(!is.na(serving_avg))\r\n    if(length(good) > 0){\r\n      if(length(good) > 1) {\r\n        lines(good, serving_avg[good], type = \"o\", pch = 16, lwd = 2, col = \"gray\")\r\n      } else {\r\n        points(good, serving_avg[good], pch = 16, col = point_colors[good], cex = 2)\r\n      }\r\n      points(good, serving_avg[good], pch = 16, col = point_colors[good], cex = 2)\r\n    }\r\n    \r\n    axis(1, at = 1:nrow(pdata), labels = format(pdata$Date, \"%m-%d\"), las = 2, cex.axis = 0.7)\r\n    abline(h = 0.5, col = \"black\", lty = 2)\r\n  })\r\n  \r\n  # ----------------------\r\n  # Top Scorers\r\n  # ----------------------\r\n  output$top_scorers <- renderPlot({\r\n    df <- stats_df[order(stats_df$TotalPointsWon, decreasing = TRUE), ]\r\n    df <- df[nrow(df):1, ]\r\n    bar_colors <- colorRampPalette(c(\"green\", \"darkgreen\"))(nrow(df))\r\n    par(mar = c(5, 8, 4, 2))\r\n    barplot(df$TotalPointsWon,\r\n            names.arg = df$Name,\r\n            horiz = TRUE,\r\n            las = 1,\r\n            col = bar_colors,\r\n            main = \"Top Scorers\",\r\n            xlab = \"Total Points Won\",\r\n            cex.names = 0.8,\r\n            xlim = c(0, max(df$TotalPointsWon, na.rm = TRUE)*1.1))\r\n  })\r\n  \r\n  # ----------------------\r\n  # Top Errors\r\n  # ----------------------\r\n  output$top_errors <- renderPlot({\r\n    df <- stats_df[order(stats_df$TotalUnforcedErrors, decreasing = TRUE), ]\r\n    df <- df[nrow(df):1, ]\r\n    par(mar = c(5, 8, 4, 2))\r\n    bar_colors <- colorRampPalette(c(\"mistyrose\", \"red3\"))(nrow(df))\r\n    barplot(df$TotalUnforcedErrors,\r\n            names.arg = df$Name,\r\n            horiz = TRUE,\r\n            las = 1,\r\n            col = bar_colors,\r\n            main = \"Top Unforced Errors\",\r\n            xlab = \"Total Unforced Errors\",\r\n            cex.names = 0.8,\r\n            xlim = c(0, max(df$TotalUnforcedErrors, na.rm = TRUE)*1.1))\r\n  })\r\n  \r\n  # ----------------------\r\n  # Net Score Heatmap\r\n  # ----------------------\r\n  output$net_score_heatmap <- renderPlot({\r\n    pdata <- VolleyData\r\n    pdata$NetScoreRate <- (pdata$PointWon - pdata$UnforcedError)/pdata$TeamTotalScore\r\n    \r\n    players <- unique(pdata$Name)\r\n    dates <- sort(unique(pdata$Date))\r\n    \r\n    mat <- matrix(NA, nrow = length(players), ncol = length(dates),\r\n                  dimnames = list(players, as.character(dates)))\r\n    \r\n    for(i in 1:nrow(pdata)){\r\n      mat[pdata$Name[i], as.character(pdata$Date[i])] <- pdata$NetScoreRate[i]\r\n    }\r\n    \r\n    mat[is.na(mat)] <- 0\r\n    mat[mat > 0.33] <- 0.33\r\n    mat[mat < -0.33] <- -0.33\r\n    \r\n    n_colors <- 100\r\n    cols <- colorRampPalette(c(\"red\", \"white\", \"green\"))(n_colors)\r\n    z_col <- ceiling((mat + 0.33)/(0.66)*(n_colors-1)) + 1\r\n    \r\n    layout(matrix(c(1,2), nrow=1), widths = c(4,1))\r\n    par(mar = c(6, 9, 4, 1))\r\n    image(1:length(dates), 1:length(players),\r\n          t(z_col[nrow(z_col):1,]),\r\n          col = cols,\r\n          axes = FALSE,\r\n          xlab = \"\", ylab = \"\",\r\n          main = \"Net Score Rate Heatmap\")\r\n    \r\n    axis(1, at = 1:length(dates),\r\n         labels = format(dates, \"%m-%d\"),\r\n         las = 2, cex.axis = 0.7)\r\n    \r\n    axis(2, at = 1:length(players),\r\n         labels = rev(players),\r\n         las = 1, cex.axis = 0.8)\r\n    \r\n    par(mar = c(6, 2, 4, 4))\r\n    y_vals <- seq(-0.33, 0.33, length.out = n_colors)\r\n    z_mat <- matrix(1:n_colors, nrow=1)\r\n    image(1:2, y_vals, z_mat, col=cols, axes=FALSE, xlab=\"\", ylab=\"\")\r\n    axis(4, at = pretty(y_vals), labels = round(pretty(y_vals),2), las=1)\r\n    layout(1)\r\n  })\r\n  \r\n}\r\n\r\n# Run App\r\nshinyApp(ui, server)\r\n","type":"text"},{"name":"VolleyballDashboard.Rproj","content":"Version: 1.0\r\n\r\nRestoreWorkspace: Default\r\nSaveWorkspace: Default\r\nAlwaysSaveHistory: Default\r\n\r\nEnableCodeIndexing: Yes\r\nUseSpacesForTab: Yes\r\nNumSpacesForTab: 2\r\nEncoding: UTF-8\r\n\r\nRnwWeave: Sweave\r\nLaTeX: pdfLaTeX\r\n","type":"text"},{"name":"VolleyballData2025.csv","content":"ï»¿Name,Date,Opponent,Team,ServeIn,ServeOut,TotalServe,PointWon,Assist,UnforcedError,TeamTotalScore,OpponentTotalScore\r\nNoah H.,11/19/2025,Garvey,A,2,3,5,11,2,5,40,50\r\nJeffrey T.,11/19/2025,Garvey,A,3,3,6,4,3,7,40,50\r\nCollin K.,11/19/2025,Garvey,A,1,0,1,5,0,2,40,50\r\nMichelle C.,11/19/2025,Garvey,A,0,3,3,1,0,3,40,50\r\nMason L.,11/19/2025,Garvey,A,1,1,2,1,4,3,40,50\r\nVivian C.,11/19/2025,Garvey,A,1,1,2,1,4,7,40,50\r\nAdrian N.,11/19/2025,Garvey,B,0,0,0,4,4,7,40,50\r\nEmily D.,11/19/2025,Garvey,B,0,0,0,3,0,2,40,50\r\nJulie T.,11/19/2025,Garvey,B,1,1,2,1,0,1,40,50\r\nNoah H.,12/3/2025,Garvey,A,4,1,5,7,0,7,50,43\r\nThang P.,12/3/2025,Garvey,A,0,0,0,7,0,1,50,43\r\nMason L.,12/3/2025,Garvey,A,10,1,11,4,1,3,50,43\r\nChloe L.,12/3/2025,Garvey,A,0,1,1,0,0,8,50,43\r\nKelly C.,12/3/2025,Garvey,A,9,1,10,3,1,2,50,43\r\nJulie T.,12/3/2025,Garvey,A,0,0,0,1,0,5,50,43\r\nCollin K.,12/3/2025,Garvey,B,6,3,9,3,1,5,50,43\r\nVivian C.,12/3/2025,Garvey,B,3,0,3,0,1,3,50,43\r\nMichelle C.,12/3/2025,Garvey,B,3,3,6,2,1,4,50,43\r\nJoseph D.,12/3/2025,Garvey,B,2,0,2,0,0,1,50,43\r\nDerek C.,12/3/2025,Garvey,B,0,0,0,0,1,3,50,43\r\nNoah H.,12/13/2025,Carver,A,3,1,4,3,1,2,15,8\r\nThang P.,12/13/2025,Carver,A,0,0,0,0,0,0,15,8\r\nMason L.,12/13/2025,Carver,A,1,0,1,0,0,0,15,8\r\nChloe L.,12/13/2025,Carver,A,0,0,0,0,0,0,15,8\r\nKelly C.,12/13/2025,Carver,A,1,1,2,1,0,2,15,8\r\nJulie T.,12/13/2025,Carver,A,0,0,0,0,0,1,15,8\r\nAdrian N.,12/13/2025,Carver,B,0,1,1,1,0,2,15,8\r\nJohnathan D.,12/13/2025,Carver,B,0,0,0,0,0,0,15,8\r\nVivian C.,12/13/2025,Carver,B,1,1,2,1,0,1,15,8\r\nMichelle C.,12/13/2025,Carver,B,4,0,4,4,0,1,15,8\r\nNoah H.,12/14/2025,South Gate,A,0,0,0,0,0,0,4,15\r\nThang P.,12/14/2025,South Gate,A,0,0,0,0,0,0,4,15\r\nMason L.,12/14/2025,South Gate,A,1,1,2,2,0,2,4,15\r\nChloe L.,12/14/2025,South Gate,A,0,0,0,0,0,0,4,15\r\nKelly C.,12/14/2025,South Gate,A,0,0,0,0,0,2,4,15\r\nJulie T.,12/14/2025,South Gate,A,0,0,0,0,0,2,4,15\r\nAdrian N.,12/14/2025,South Gate,B,0,0,0,1,0,3,4,15\r\nJohnathan D.,12/14/2025,South Gate,B,1,0,1,0,0,0,4,15\r\nVivian C.,12/14/2025,South Gate,B,0,0,0,0,0,1,4,15\r\nMichelle C.,12/14/2025,South Gate,B,1,0,1,0,0,1,4,15\r\nNoah H.,12/15/2025,International,A,0,0,0,1,0,2,15,8\r\nThang P.,12/15/2025,International,A,0,0,0,1,0,0,15,8\r\nMason L.,12/15/2025,International,A,2,0,2,1,0,0,15,8\r\nChloe L.,12/15/2025,International,A,0,0,0,0,0,0,15,8\r\nKelly C.,12/15/2025,International,A,2,1,3,0,0,1,15,8\r\nJohnathan D.,12/15/2025,International,B,0,1,1,2,0,0,15,8\r\nVivian C.,12/15/2025,International,B,5,1,6,3,0,0,15,8\r\nMichelle C.,12/15/2025,International,B,2,0,2,1,0,1,15,8\r\nNoah H.,12/16/2025,Garvey,A,1,1,2,5,0,3,15,8\r\nThang P.,12/16/2025,Garvey,A,0,0,0,0,0,1,15,8\r\nMason L.,12/16/2025,Garvey,A,2,0,2,0,0,0,15,8\r\nChloe L.,12/16/2025,Garvey,A,0,0,0,1,0,1,15,8\r\nKelly C.,12/16/2025,Garvey,A,1,0,1,0,0,1,15,8\r\nJohnathan D.,12/16/2025,Garvey,B,2,0,2,1,2,1,15,8\r\nVivian C.,12/16/2025,Garvey,B,3,0,3,0,0,1,15,8\r\nMichelle C.,12/16/2025,Garvey,B,4,0,4,1,0,0,15,8\r\nNoah H.,12/17/2025,ELC,A,0,0,0,4,0,1,30,14\r\nThang P.,12/17/2025,ELC,A,0,0,0,3,0,0,30,14\r\nMason L.,12/17/2025,ELC,A,0,0,0,0,0,1,30,14\r\nChloe L.,12/17/2025,ELC,A,0,0,0,1,0,2,30,14\r\nKelly C.,12/17/2025,ELC,A,2,0,2,2,0,3,30,14\r\nAdrian N.,12/17/2025,ELC,B,5,1,6,6,0,1,30,14\r\nJohnathan D.,12/17/2025,ELC,B,3,2,5,3,0,1,30,14\r\nVivian C.,12/17/2025,ELC,B,3,1,4,1,0,1,30,14\r\nMichelle C.,12/17/2025,ELC,B,10,1,11,5,0,1,30,14\r\nEmily D.,12/17/2025,ELC,B,0,0,0,0,0,0,30,14\r\nAngel R.,12/17/2025,ELC,B,1,0,1,0,0,0,30,14\r\nNoah H.,12/18/2025,South Gate,A,4,2,6,5,0,3,26,38\r\nThang P.,12/18/2025,South Gate,A,0,0,0,1,0,2,26,38\r\nMason L.,12/18/2025,South Gate,A,1,0,1,0,0,2,26,38\r\nChloe L.,12/18/2025,South Gate,A,0,0,0,1,0,2,26,38\r\nKelly C.,12/18/2025,South Gate,A,0,1,1,1,0,2,26,38\r\nAdrian N.,12/18/2025,South Gate,B,0,0,0,0,0,0,26,38\r\nJohnathan D.,12/18/2025,South Gate,B,1,1,2,2,0,5,26,38\r\nVivian C.,12/18/2025,South Gate,B,4,0,4,0,0,5,26,38\r\nMichelle C.,12/18/2025,South Gate,B,4,2,6,1,0,5,26,38\r\n","type":"text"}]
